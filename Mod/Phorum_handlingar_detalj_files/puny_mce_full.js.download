!function(e){function t(e,t){return e=typeof e,t?e==t:"undefined"!=e}function n(e,n,o){var i;if(!e)return 0;if(o=o?o:e,t(e.length)){for(i=0;i<e.length;i++)if(n.call(o,e[i],i,e)===!1)return 0}else for(i in e)if(e.hasOwnProperty(i)&&n.call(o,e[i],i,e)===!1)return 0;return 1}function o(e,t){return n(t,function(t,n){e[n]=t}),e}var i,a,r,s,c,d,l,u,g,m,f,p,h;h=navigator.userAgent,e.isOpera=m=window.opera&&opera.buildNumber,e.isWebKit=f=/WebKit/.test(h),e.isOldWebKit=p=f&&!window.getSelection().getRangeAt,e.isIE=u=!f&&!m&&/MSIE/gi.test(h)&&/Explorer/gi.test(navigator.appName);var v=/MSIE (\d+\.\d+);/.test(navigator.userAgent)?parseFloat(RegExp.$1):NaN;e.useTextRange=v<9,e.isGecko=g=!f&&/Gecko/.test(h),e.plugins={},o(e,{is:t,each:n,extend:o}),e.I18n=d={bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",underline:"Underline (Ctrl+U)",strike:"Striketrough",ul:"Insert unordered list",ol:"Insert ordered list",indent:"Indent",outdent:"Outdent",left:"Align left",center:"Align center",right:"Align right",style:"Font style",removeformat:"Remove format",increasefontsize:"Increase text size",decreasefontsize:"Decrease text size"},e.DOMUtils=i=function(i){this.files=[];try{i.execCommand("BackgroundImageCache",0,1)}catch(e){}o(this,{get:function(e){return e&&(e.nodeType||e.location?e:i.getElementById(e))},add:function(e,t,o,a){var r,s=this;return r=i.createElement(t),n(o,function(e,t){s.setAttr(r,t,e)}),a&&(a.nodeType?r.appendChild(a):r.innerHTML=a),e?e.appendChild(r):r},create:function(e,t,n){return this.add(0,e,t,n)},setAttr:function(e,t,n){return(e=this.get(e))?("style"==t&&(e.setAttribute("mce_style",n),e.style.cssText=n),"class"==t&&(e.className=n),null!=n&&""!=n?e.setAttribute(t,""+n):e.removeAttribute(t),1):0},getAttr:function(e,n,o){var i;return!!(e=this.get(e))&&(t(o)||(o=""),/^(src|href|style)$/.test(n)&&(i=this.getAttr(e,"mce_"+n))?i:(i=e.getAttribute(n,2),"class"!=n||i||(i=e.className),"style"!=n||i?i||(i=e.attributes[n],i=i&&t(i.nodeValue)?i.nodeValue:i):i=e.style.cssText,f&&"class"==n&&i&&(i=i.replace(/(apple|webkit)\-[a-z\-]+/gi,"")),i&&""!=i?""+i:o))},select:function(e,t,o){var a=[];return t=this.get(t),t=t?t:i,n(e.split(","),function(e){n(t.getElementsByTagName(e),function(e){o&&!o(e)||a.push(e)})}),a},getPos:function(t,n){var o,i,a=0,r=0;if(t=this.get(t),e.isIE&&t)return o=t.getBoundingClientRect(),i=document,t="CSS1Compat"==i.compatMode?i.documentElement:i.body,{x:o.left+(t.scrollLeft||0),y:o.top+(t.scrollTop||0)};for(;t&&t!=n;)a+=t.offsetLeft||0,r+=t.offsetTop||0,t=t.offsetParent;return{x:a,y:r}},loadCSS:function(e){var t=this;e&&n(e.split(","),function(e){var o=-1;n(t.files,function(t,n){if(t==e)return o=n,!1}),o==-1&&(t.files.push(e),i.createStyleSheet?i.createStyleSheet(e):t.add(t.select("head")[0],"link",{rel:"stylesheet",href:e}))})},addClass:function(e,t,n){var o;return(e=this.get(e))?(o=this.removeClass(e,t),e.className=n?t+(""!=o?" "+o:""):(""!=o?o+" ":"")+t):0},removeClass:function(e,t){return(e=this.get(e))?(t=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)","g")," "),e.className=" "!=t?t:""):0},hasClass:function(e,t){return e=this.get(e),new RegExp("\\b"+t+"\\b","g").test(e.className)},getParent:function(e,t,n){for(;e;){if(e==n)return null;if(t(e))return e;e=e.parentNode}return null},keep:function(e){return g&&(e=e.replace(/<(\/?)strong>|<strong( [^>]+)>/gi,"<$1b$2>"),e=e.replace(/<(\/?)em>|<em( [^>]+)>/gi,"<$1i$2>"),e=e.replace(/<(\/?)del|<del( [^>]+)>/gi,"<$1strike$2>")),e=e.replace(/ (src|href|style)=\"([^\"]+)\"/gi,' $1="$2" mce_$1="$2"')}})},e.DOM=l=new i(document),e.Event=s={events:[],inits:[],unloads:[],add:function(e,t,n,o){var i,a=this,r=a.events;return e=l.get(e),i=function(e){return e=e||window.event,e&&!e.target&&u&&(e.target=e.srcElement),o?n.call(o,e):n(e)},"unload"==t?(a.unloads.push(i),i):"init"==t?(a._init?i():a.inits.push(i),i):(r.push({obj:e,name:t,func:n,cfunc:i,scope:o}),a._add(e,t,i),u&&1==r.length&&s._add(window,"unload",a._unload,s),i)},remove:function(e,t,o){var i=this,a=i.events;e=l.get(e),n(a,function(n,r){if(n.obj==e&&n.name==t&&(!o||n.func==o))return a.splice(r,1),i._remove(e,t,n.cfunc),!1})},cancel:function(e){return this.stop(e),this.prevent(e)},stop:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},prevent:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,!1},_unload:function(){var e=s;n(e.events,function(t){e._remove(t.obj,t.name,t.cfunc)}),e._remove(window,"unload",e._unload),e.events=[],n(e.unloads,function(e){e()})},_add:function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener?e.addEventListener(t,n,!1):e["on"+t]=n},_remove:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener?e.removeEventListener(t,n,!1):e["on"+t]=null},_pageInit:function(){var e=s;e._remove(window,"DOMContentLoaded",e._pageInit),e._init=!0,n(e.inits,function(e){e()}),e.inits=[]},_wait:function(){var e;u&&"https:"!=document.location.protocol?(document.write("<script id=__ie_onload defer src=javascript:void(0)></script>"),l.get("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&(s._pageInit(),l.get("__ie_onload").onreadystatechange=null)}):(s._add(window,"DOMContentLoaded",s._pageInit,s),(u||f)&&(e=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(e),s._pageInit())},10)))}},e.Dispatcher=r=function(e){var t=[];e||(e=this),o(this,{add:function(n,o){return t.push({cb:n,scope:o?o:e}),n},remove:function(e){return n(t,function(n,o){return e==n.cb&&t.splice(o,1),!1}),e},dispatch:function(){var e,o=arguments;return n(t,function(t){return e=t.cb.apply(t.scope,o)}),e}})},e.Editor=function(p){function h(e){var t,n,o,i;t=l.get(b.id+"_c"),o=t.clientWidth-2,i=t.clientHeight-2,n=l.get(b.id+"_p"),n.style.width=o+"px",n.style.height=i+"px",t.style.display="none",n.style.display="block",S.resize={x:e.screenX,y:e.screenY,w:o,h:i},s.add(document,"mousemove",v,this),s.add(document,"mouseup",C,this),S.onResizeStart.dispatch(S,e,o,i)}function v(e){var t,n,o,i=S.resize;return i.dx=e.screenX-i.x,i.dy=e.screenY-i.y,n=Math.max(b.min_width,i.w+i.dx),o=Math.max(b.min_height,i.h+i.dy),n=Math.min(b.max_width,n),o=Math.min(b.max_height,o),t=l.get(b.id+"_p"),t.style.width=n+"px",t.style.height=o+"px",s.cancel(e)}function C(e){var t=S.resize;s.remove(document,"mousemove",v,this),s.remove(document,"mouseup",C,this),l.get(b.id+"_c").style.display="",l.get(b.id+"_p").style.display="none",S.resizeBy(t.dx,t.dy),S.onResizeEnd.dispatch(S,e,t.dx,t.dy)}function y(){var n=l.get(b.id),o=S.getDoc();g&&(S.getDoc().designMode="On"),o.open(),o.write('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body id="punymce"></body></html>'),o.close(),S.dom=N=new i(S.getDoc()),N.loadCSS(b.content_css),S.onPreInit.dispatch(S),b.spellcheck||(S.getBody().spellcheck=0),s.add(S.getDoc(),"mouseup",S.nodeChanged,S),s.add(S.getDoc(),"keyup",S.nodeChanged,S),s.add(g?S.getDoc():S.getWin(),"focus",function(t){var n;null!=(n=e.focusEditor)&&n.onBlur.dispatch(n,S),S.onFocus.dispatch(S,n),e.focusEditor=S},this),u?S.getBody().contentEditable=!0:S.getDoc().designMode="On",S.setContent(t(n.value)?n.value:n.innerHTML,{load:!0}),l.get(b.id+"_c").style.display=S.orgDisplay,l.get(b.id).style.display="none",S.onInit.dispatch(S)}var b,N,S=this;e.baseURL||(e.baseURL="https://static.websimages.com/JS/Punymce"),this.settings=b=o({content_css:e.baseURL+"/css/content.css",editor_css:e.baseURL+"/css/editor.css",width:0,height:0,min_width:260,min_height:50,max_width:800,max_height:600,entities:"raw",spellcheck:0,resize:!0,plugins:"",styles:[{title:"H1",cls:"h1",cmd:"FormatBlock",val:"<h1>"},{title:"H2",cls:"h2",cmd:"FormatBlock",val:"<h2>"},{title:"H3",cls:"h3",cmd:"FormatBlock",val:"<h3>"},{title:"Pre",cls:"pre",cmd:"FormatBlock",val:"<pre>"},{title:"Times",cls:"times",cmd:"FontName",val:"Times"},{title:"Arial",cls:"arial",cmd:"FontName",val:"Arial"},{title:"Courier",cls:"courier",cmd:"FontName",val:"Courier"}],toolbar:"bold,italic,underline,strike,increasefontsize,decreasefontsize,ul,ol,indent,outdent,left,center,right,style,removeformat"},p),S.tools={bold:{cmd:"Bold",title:d.bold},italic:{cmd:"Italic",title:d.italic},underline:{cmd:"Underline",title:d.underline},strike:{cmd:"Strikethrough",title:d.strike},ul:{cmd:"InsertUnorderedList",title:d.ul},ol:{cmd:"InsertOrderedList",title:d.ol},indent:{cmd:"Indent",title:d.indent},outdent:{cmd:"Outdent",title:d.outdent},left:{cmd:"JustifyLeft",title:d.left},center:{cmd:"JustifyCenter",title:d.center},right:{cmd:"JustifyRight",title:d.right},style:{cmd:"mceStyle",title:d.style},removeformat:{cmd:"RemoveFormat",title:d.removeformat},increasefontsize:{cmd:"IncreaseFontSize",title:d.increasefontsize},decreasefontsize:{cmd:"DecreaseFontSize",title:d.decreasefontsize}},l.loadCSS(b.editor_css),this.commands={mceStyle:function(e,t,o){function i(e){r.hideMenu=null,s.remove(document,"click",i),s.remove(r.getDoc(),"click",i),l.get(d+"_mstyle").style.display="none"}var a,r=this,c=r.settings,d=c.id,u=l.getPos(o.target);if(r.hideMenu)return r.hideMenu();a=l.get(d+"_mstyle"),a||(a=l.get(d+"_t"),a=l.add(document.body,"div",{id:d+"_mstyle",class:"punymce_style punymce"}),n(c.styles,function(e){s.add(l.add(a,"a",{href:"#",class:e.cls},e.title),"mousedown",function(t){return i.call(r),r.execCommand(e.cmd,e.ui,e.val),m&&r.getIfr().focus(),s.cancel(t)})})),r.hideMenu=i,s.add(document,"click",i,r),s.add(r.getDoc(),"click",i,r),c=a.style,c.left=u.x+"px",c.top=u.y+o.target.clientHeight+2+"px",c.display="block"},FormatBlock:function(e,t,n){g&&/<(div|blockquote|code|dt|dd|dl|samp)>/gi.test(t)&&(t=t.replace(/[^a-z]/gi,"")),S.getDoc().execCommand("FormatBlock",0,t)},CreateLink:function(e,t){var o=S.dom,i="javascript:mox();";S.getDoc().execCommand("CreateLink",0,i),n(o.select("A"),function(e){if(o.getAttr(e,"href")==i){var n=t.indexOf("http://")>-1?t:"http://"+t;e.innerHTML==i&&(e.innerHTML=n),o.setAttr(e,"href",n),o.setAttr(e,"mce_href",n),o.setAttr(e,"target","_blank"),o.setAttr(e,"mce_target","_blank")}})},mceFontSizeDelta:function(e,t){var o,i=S.getDoc();S.selection;o=parseInt(i.queryCommandValue("FontSize")||3),f&&n([10,13,16,18,24,32,48],function(e,t){if(o==e)return o=t+1,!1}),o+t<=1||i.execCommand("FontSize",!1,o+t)},IncreaseFontSize:function(){S.execCommand("mceFontSizeDelta",0,1)},DecreaseFontSize:function(){S.execCommand("mceFontSizeDelta",0,-1)},Indent:function(e,t,n){S.getDoc().execCommand("Indent",0,0),u&&S.dom.getParent(S.selection.getNode(),function(e){"BLOCKQUOTE"==e.nodeName&&(e.dir=e.style.marginRight="")})},mceSetClass:function(e,n,o){var i=S.selection;t(n,"string")&&(n={element:"span",class:n}),i.isCollapsed()?S.dom.setAttr(i.getNode(),"class",n.class):i.setContent("<"+n.element+' class="'+n.class+'">'+i.getContent()+"</"+n.element+">")},RemoveFormat:function(e,t,n){var o=S.selection;S.getDoc().execCommand("RemoveFormat",e,t),u&&(t=o.getContent(),t=t.replace(/ (class|style)=\"[^\"]+\"/g,""),t=t.replace(/<\/?(font|strong|em|b|i|u|strike)>/g,""),t=t.replace(/<(font|strong|em|b|i|u|strike) [^>]+>/g,""),o.setContent(t))}},o(this,{serializer:new c(S),selection:new a(S),plugins:[]}),n(["onPreInit","onInit","onFocus","onBlur","onResizeStart","onResizeEnd","onPreProcess","onPostProcess","onSetContent","onBeforeGetContent","onGetContent","onNodeChange"],function(e){S[e]=new r(S)}),o(this,{init:function(){var t,o,i,a,r,c,d,u=l.get(b.id),g=u.parentNode,m=["bold","italic","underline","left","center","right"];n(b.plugins.split(","),function(t){t&&S.plugins.push(new e.plugins[t](S))}),S.onNodeChange.add(function(){n(m,function(e){var t;try{t=S.getDoc().queryCommandState(S.tools[e].cmd)?l.addClass:l.removeClass,t.call(l,b.id+"_"+e,"active")}catch(e){}})}),"numeric"==b.entities&&S.onGetContent.add(function(e,t){"html"==t.format&&(t.content=t.content.replace(/[\u007E-\uFFFF]/g,function(e){return"&#"+e.charCodeAt(0)+";"}))}),t=b.width?b.width:u.offsetWidth,o=b.height?b.height:u.offsetHeight,S.orgDisplay=u.style.display,u.style.display="none",u.form&&(d=u.form,S._submit=d.submit,d.submit=function(){var e=l.get(b.id),t=e.form;S.save(),t.submit=S._submit,t.submit()},s.add(0,"unload",function(){l.get(b.id).form;S._submit=S.submit=null}),s.add(d,"submit",S.save,S)),i='<div id="'+b.id+'_w" class="punymce"><table id="'+b.id+'_c" class="punymce"><tr class="mceToolbar">',i+='<td id="'+b.id+'_t"></td></tr><tr class="mceBody"><td></div><div id="'+b.id+'_b" class="mceBody">',b.resize&&(i+='<div id="'+b.id+'_r" class="mceResize"></div>'),i+="</td></tr></table>",i+='<div id="'+b.id+'_p" class="mcePlaceholder"></div></div>',u.insertAdjacentHTML?u.insertAdjacentHTML("beforeBegin",i):(c=u.ownerDocument.createRange(),c.setStartBefore(u),g.insertBefore(c.createContextualFragment(i),u)),r=l.get(b.id+"_t"),a=l.add(r,"ul",{id:b.id+"_tb",class:"punymce"}),n(b.toolbar.split(","),function(e){var t=S.tools[e];r=l.add(l.add(a,"li",{id:b.id+"_"+e,class:e}),"a",{href:"javascript:void(0);",class:e,title:t.title,tabIndex:-1,onmousedown:"return false;"}),s.add(r,"click",function(e){return l.hasClass(e.target.parentNode,"disabled")||S.execCommand(t.cmd,0,0,e),s.cancel(e)})}),r=l.get(b.id+"_b"),r=l.add(r,"iframe",{id:b.id+"_f",src:'javascript:""',frameBorder:"0",class:"punymce",style:"width:"+t+"px;height:"+o+"px"}),S.resizeTo(t,o),f?(s.add(r,"load",y,S),window.fwAppsURL?r.src=fwAppsURL+"util/blank.html":r.src="https://members.webs.com/Platform/Public/blank.html"):y(),b.resize&&s.add(b.id+"_r","mousedown",function(e){return h(e,b.id)},this),a=d=u=r=null},getSize:function(){var e=l.get(b.id+"_f");return{w:e.clientWidth,h:e.clientHeight}},resizeTo:function(e,t){var n=l.get(b.id+"_f").style;e=Math.max(b.min_width,e),t=Math.max(b.min_height,t),e=Math.min(b.max_width,e),t=Math.min(b.max_height,t),S.width=e,S.height=t,n.width=e+"px",n.height=t+"px"},resizeBy:function(e,t){var n=S.getSize();S.resizeTo(n.w+e,n.h+t)},show:function(){l.get(b.id+"_w").style.display="block",l.get(b.id).style.display="none",S.load()},hide:function(){u&&S.execCommand("SelectAll"),l.get(b.id+"_w").style.display="none",l.get(b.id).style.display=S.orgDisplay,S.save()},load:function(){var e=l.get(b.id);S.setContent(t(e.value)?e.value:e.innerHTML,{load:!0})},save:function(){var e=l.get(b.id),t=S.getContent({save:!0});/TEXTAREA|INPUT/.test(e.nodeName)?e.value=t:e.innerHTML=t},setUseCSS:function(e){var t=S.getDoc();try{t.execCommand("styleWithCSS",0,!1)}catch(e){try{t.execCommand("useCSS",0,!0)}catch(e){}}},execCommand:function(e,t,n,o){var i,a=S.commands;S.getWin().focus(),S.setUseCSS(0),(i=a[e]?a[e].call(S,t,n,o):S.getDoc().execCommand(e,t,n))!==!1&&S.nodeChanged()},getContent:function(e){var t;return e=e||{},e.format=e.format||"html",S.onBeforeGetContent.dispatch(this,e),t=S.serializer.serialize(S.getBody(),e),t=t.replace(/^\s*|\s*$/g,""),e.content=t,S.onGetContent.dispatch(this,e),e.content},setContent:function(e,t){return t=t||{},t.content=e,S.onSetContent.dispatch(this,t),e=t.content,e=l.keep(e),S.getBody().innerHTML=e,"raw"!=t.format?S.setContent(e=S.getContent(t),{format:"raw"}):S.getBody().innerHTML=e,e},getIfr:function(){return l.get(b.id+"_f")},getWin:function(){return S.getIfr().contentWindow},getDoc:function(){return S.getWin().document},getBody:function(){return S.getDoc().body},nodeChanged:function(){S.setUseCSS(0),S.onNodeChange.dispatch(S,S.selection.getNode())}}),s.add(window,"init",S.init,this)},e.Selection=a=function(n){var i=this;o(i,{getContent:function(e){var o,a=i.getRng(),r=document.createElement("body");return e=e||{},i.isCollapsed()?"":(a.cloneContents?r.appendChild(a.cloneContents()):t(a.item)||t(a.htmlText)?r.innerHTML=a.item?a.item(0).outerHTML:a.htmlText:r.innerHTML=a.toString(),"raw"!=e.format?(e.content=o,n.serializer.serialize(r,e),e.content=e.content.replace(/^\s*|\s*$/g,""),n.onGetContent.dispatch(o,e),o=e.content):o=r.innerHTML,o)},getText:function(){var e=i.getRng(),t=i.getSel();return p?t:i.isCollapsed()?"":e.text||t.toString()},setContent:function(e,t){var o,a,r,s,r=i.getRng();t=t||{format:"raw"},e=l.keep(e),"raw"!=t.format&&(t.content=e,e=n.onSetContent.dispatch(this,t),e=t.content,o=n.dom.create("body"),o.innerHTML=e),r.insertNode?(r.deleteContents(),r.insertNode(r.createContextualFragment(e+'<span id="__caret">_</span>')),a=n.dom.get("__caret"),r=n.getDoc().createRange(),r.setStartBefore(a),r.setEndBefore(a),s=i.getSel(),s.removeAllRanges(),s.addRange(r),a.parentNode.removeChild(a)):r.pasteHTML?r.pasteHTML(e):r.item(0).outerHTML=e},select:function(e,t){var n=i.getRng(),o=i.getSel();if(n.moveToElementText)try{n.moveToElementText(e),n.select()}catch(e){}else o.addRange?(t?n.selectNodeContents(e):n.selectNode(e),o.removeAllRanges(),o.addRange(n)):o.setBaseAndExtent(e,0,e,1);return e},isCollapsed:function(){var e=i.getRng();return!e.item&&(0==e.boundingWidth||i.getSel().isCollapsed)},collapse:function(e){var t=i.getRng(),n=i.getSel();t.select?(t.collapse(e),t.select()):e?n.collapseToStart():n.collapseToEnd()},getSel:function(){var e=n.getWin();return e.getSelection?e.getSelection():n.getDoc().selection},getRng:function(){var e=i.getSel(),t=n.getDoc();if(!e)return null;try{return e.rangeCount>0?e.getRangeAt(0):e.createRange?e.createRange():null}catch(e){return t.body.createTextRange()}},setRng:function(e){var t=i.getSel();t.removeAllRanges(),t.addRange(e)},setNode:function(e){i.setContent(n.dom.create("div",null,e).innerHTML)},getNode:function(){var t,n=i.getRng();i.getSel();return e.useTextRange?n.item?n.item(0):n.parentElement():(n&&(t=n.commonAncestorContainer,n.collapsed||n.startContainer==n.endContainer&&n.startOffset-n.endOffset<2&&n.startContainer.hasChildNodes()&&(t=n.startContainer.childNodes[n.startOffset])),l.getParent(t,function(e){return 1==e.nodeType}))}})},e.Serializer=c=function(e){function t(e){var t=[];return e.cloneNode(!1).outerHTML.replace(/([a-z0-9\-_]+)=/gi,function(e,n){t.push({specified:1,nodeName:n})}),t}function n(e,o){var s,c,d,g,m,f,p,h;if(a.valid_nodes&&!a.valid_nodes.test(e.nodeName)||a.invalid_nodes&&a.invalid_nodes.test(e.nodeName)||a.node_filter&&!a.node_filter(e,o))1==e.nodeType&&(s=e.hasChildNodes());else switch(e.nodeType){case 1:if(u){if(e.mce_serialized==r)return;e.mce_serialized=r}for(s=e.hasChildNodes(),c=i.createElement(e.nodeName.toLowerCase()),f=u?t(e):e.attributes,g=f.length-1;g>-1;g--)if(p=f[g],p.specified){if(m=p.nodeName.toLowerCase(),a.invalid_attrs&&a.invalid_attrs.test(m))continue;if(a.valid_attrs&&!a.valid_attrs.test(m))continue;h=l.getAttr(e,m),""!==h&&c.setAttribute(m,h)}s||a.closed.test(e.nodeName)||c.appendChild(i.createTextNode("")),o=o.appendChild(c);break;case 3:return o.appendChild(i.createTextNode(e.nodeValue));case 8:return o.appendChild(i.createComment(e.nodeValue))}if(s)for(d=e.firstChild;d;)n(d,o),d=d.nextSibling}var i,a,r=0;i=function(){var e=document.implementation;if(e&&e.createDocument)return e.createDocument("","",null);try{return new ActiveXObject("MSXML2.DOMDocument")}catch(e){}try{return new ActiveXObject("Microsoft.XmlDom")}catch(e){}}(),this.settings=a=o({valid_nodes:0,invalid_nodes:/(BODY)/,valid_attrs:0,node_filter:0,root_node:0,pi:0,invalid_attrs:/(^mce_|^_moz_|^contenteditable$)/,closed:/(BR|HR|INPUT|META|IMG)/},e.settings.serializer),o(this,{serialize:function(t,o){var s;return r=""+(parseInt(r)+1),i.firstChild&&i.removeChild(i.firstChild),t=o.node=t.cloneNode(1),e.onPreProcess.dispatch(this,o),n(t,i.appendChild(i.createElement("html"))),s=i.xml||(new XMLSerializer).serializeToString(i),a.pi||(s=s.replace(/<\?[^?]+\?>/g,"")),a.root_node||(s=s.replace(/<html>|<\/html>/g,"")),o.content=s,e.onPostProcess.dispatch(this,o),o.content}})},s._wait(),window.punymce=e}({}),function(e){e.plugins.ForceBlocks=function(t){function n(){u=t.dom,C.add(t.getDoc(),"keyup",a),t.onSetContent.add(a),t.onBeforeGetContent.add(a),g||(t.onPreProcess.add(function(e,t){p(t.node.getElementsByTagName("br"),function(t){var n=t.parentNode;!n||"p"!=n.nodeName||1!=n.childNodes.length&&n.lastChild!=t||n.replaceChild(e.getDoc().createTextNode(" "),t)})}),C.add(t.getDoc(),"keypress",function(e){if(13==e.keyCode&&!e.shiftKey&&!d(e))return C.cancel(e)}),m&&C.add(t.getDoc(),"keydown",function(e){8!=e.keyCode&&46!=e.keyCode||e.shiftKey||l(e,8==e.keyCode)}))}function o(e){var t,n;return t=e.document,n="CSS1Compat"==t.compatMode?t.documentElement:t.body,{x:e.pageXOffset||n.scrollLeft,y:e.pageYOffset||n.scrollTop,w:e.innerWidth||n.clientWidth,h:e.innerHeight||n.clientHeight}}function i(e,n,o){for(var e,i=t.getDoc().createTreeWalker(e,4,null,!1),a=-1;e=i.nextNode();){if(a++,0==n&&e==o)return a;if(1==n&&a==o)return e}return-1}function a(){var n,o,a,s,c,d,l,u,g,m,f,p,h=t.getBody(),C=t.getDoc(),y=t.selection,b=y.getSel(),N=y.getRng(),S=-2,_=-16777215,x=h.childNodes;for(m=x.length-1;m>=0;m--)c=x[m],3==c.nodeType||!r(c)&&8!=c.nodeType?d?d.hasChildNodes()?d.insertBefore(c,d.firstChild):d.appendChild(c):(3!=c.nodeType||/[^\s]/g.test(c.nodeValue))&&(S==-2&&N&&(e.useTextRange?(s=C.body.createTextRange(),s.moveToElementText(h),s.collapse(1),l=s.move("character",_)*-1,s=N.duplicate(),s.collapse(1),u=s.move("character",_)*-1,s=N.duplicate(),s.collapse(0),g=s.move("character",_)*-1-u,S=u-l,n=g):1==N.startContainer.nodeType&&(f=N.startContainer.childNodes[N.startOffset])&&1==f.nodeType?(p=f.getAttribute("id"),f.setAttribute("id","__mce")):t.dom.getParent(N.startContainer,function(e){return e===h})&&(o=N.startOffset,a=N.endOffset,S=i(h,0,N.startContainer),n=i(h,0,N.endContainer))),d=t.dom.create(v.element),d.appendChild(c.cloneNode(1)),c.parentNode.replaceChild(d,c)):d=null;if(S!=-2)if(e.useTextRange)try{N=b.createRange(),N.moveToElementText(h),N.collapse(1),N.moveStart("character",S),N.moveEnd("character",n),N.select()}catch(e){}else d=h.getElementsByTagName(v.element)[0],N=C.createRange(),S!=-1?N.setStart(i(h,1,S),o):N.setStart(d,0),n!=-1?N.setEnd(i(h,1,n),a):N.setEnd(d,0),b&&(b.removeAllRanges(),b.addRange(N));else!e.useTextRange&&(f=t.dom.get("__mce"))&&(p?f.setAttribute("id",p):f.removeAttribute("id"),N=C.createRange(),N.setStartBefore(f),N.setEndBefore(f),y.setRng(N))}function r(e){return 1==e.nodeType&&/^(H[1-6]|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CODE|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|NOFRAMES|MENU|ISINDEX|SAMP)$/.test(e.nodeName)}function s(e){return u.getParent(e,function(e){return r(e)})}function c(e){return e=e.innerHTML,e=e.replace(/<img|hr|table/g,"d"),e=e.replace(/<[^>]+>/g,""),""==e.replace(/[ \t\r\n]+/g,"")}function d(n){var i,a,d,l,g,m,p,h,C,y,b,N,S,_,x,T,D,R=t.getDoc(),I=t.selection.getSel(),E=t.selection.getRng(),k=R.body;if(e.isOldWebKit)return!0;if(i=R.createRange(),i.setStart(I.anchorNode,I.anchorOffset),i.collapse(!0),a=R.createRange(),a.setStart(I.focusNode,I.focusOffset),a.collapse(!0),d=i.compareBoundaryPoints(i.START_TO_END,a)<0,l=d?I.anchorNode:I.focusNode,g=d?I.anchorOffset:I.focusOffset,m=d?I.focusNode:I.anchorNode,p=d?I.focusOffset:I.anchorOffset,l="BODY"==l.nodeName?l.firstChild:l,m="BODY"==m.nodeName?m.firstChild:m,h=s(l),C=s(m),y=h?h.nodeName:v.element,u.getParent(h,function(e){return/OL|UL/.test(e.nodeName)}))return!0;h&&("CAPTION"==h.nodeName||/absolute|relative|static/gi.test(h.style.position))&&(y=v.element,h=null),C&&("CAPTION"==C.nodeName||/absolute|relative|static/gi.test(C.style.position))&&(y=v.element,C=null),(/(TD|TABLE|TH|CAPTION)/.test(y)||h&&"DIV"==y&&/left|right/gi.test(h.style.cssFloat))&&(y=v.element,h=C=null),b=h&&h.nodeName==y?h.cloneNode(0):R.createElement(y),N=C&&C.nodeName==y?C.cloneNode(0):R.createElement(y),N.id="",/^(H[1-6])$/.test(y)&&l.nodeValue&&g==l.nodeValue.length&&(N=R.createElement(v.element)),x=S=l;do{if(x==k||9==x.nodeType||r(x)||/(TD|TABLE|TH|CAPTION)/.test(x.nodeName))break;S=x}while(x=x.previousSibling?x.previousSibling:x.parentNode);x=_=m;do{if(x==k||9==x.nodeType||r(x)||/(TD|TABLE|TH|CAPTION)/.test(x.nodeName))break;_=x}while(x=x.nextSibling?x.nextSibling:x.parentNode);return S.nodeName==y?i.setStart(S,0):i.setStartBefore(S),i.setEnd(l,g),b.appendChild(i.cloneContents()),a.setEndAfter(_),a.setStart(m,p),N.appendChild(a.cloneContents()),E=R.createRange(),S.previousSibling||S.parentNode.nodeName!=y?i.startContainer.nodeName==y&&0==i.startOffset?E.setStartBefore(i.startContainer):E.setStart(i.startContainer,i.startOffset):E.setStartBefore(S.parentNode),_.nextSibling||_.parentNode.nodeName!=y?E.setEnd(a.endContainer,a.endOffset):E.setEndAfter(_.parentNode),E.deleteContents(),b.firstChild&&b.firstChild.nodeName==y&&(b.innerHTML=b.firstChild.innerHTML),N.firstChild&&N.firstChild.nodeName==y&&(N.innerHTML=N.firstChild.innerHTML),c(b)&&(b.innerHTML=f?" <br />":"<br />"),c(N)&&(N.innerHTML=f?" <br />":"<br />"),f?(E.insertNode(b),E.insertNode(N)):(E.insertNode(N),E.insertNode(b)),N.normalize(),b.normalize(),E=R.createRange(),E.selectNodeContents(N),E.collapse(1),I.removeAllRanges(),I.addRange(E),vp=o(t.getWin()),T=t.dom.getPos(N).y,D=N.clientHeight,(T<vp.y||T+D>vp.y+vp.h)&&t.getWin().scrollTo(0,T<vp.y?T:T-vp.h+25),!1}function l(e,n){function o(e){var t;if((e=e.target)&&e.parentNode&&"BR"==e.nodeName&&(i=s(e))){if(t=e.previousSibling,C.remove(d,"DOMNodeInserted",o),t&&3==t.nodeType&&/\s+$/.test(t.nodeValue))return;(e.previousSibling||e.nextSibling)&&e.parentNode.removeChild(e)}}var i,i,a,c,d=t.getBody(),l=t.selection,u=l.getRng(),g=u.startContainer;if(g&&r(g)&&!/^(TD|TH)$/.test(g.nodeName)&&n&&(0==g.childNodes.length||1==g.childNodes.length&&"BR"==g.firstChild.nodeName)){for(i=g;(i=i.previousSibling)&&!r(i););if(i){if(g!=d.firstChild){for(a=t.getDoc().createTreeWalker(i,NodeFilter.SHOW_TEXT,null,!1);c=a.nextNode();)i=c;u=t.getDoc().createRange(),u.setStart(i,i.nodeValue?i.nodeValue.length:0),u.setEnd(i,i.nodeValue?i.nodeValue.length:0),l.getSel().removeAllRanges(),l.getSel().addRange(u),g.parentNode.removeChild(g)}return C.cancel(e)}}C._add(d,"DOMNodeInserted",o),window.setTimeout(function(){C._remove(d,"DOMNodeInserted",o)},1)}var u,g,m,f,p,h,v,C=e.Event,y=this;g=e.isIE,m=e.isGecko,f=e.isOpera,e.isWebKit,p=e.each,h=e.extend,this.settings=v=h({element:"P"},t.settings.forceblocks),t.onPreInit.add(n,y),g||t.onSetContent.add(function(e,t){"html"==t.format&&(t.content=t.content.replace(/<p>[\s\u00a0]+<\/p>/g,"<p><br /></p>"))}),t.onPostProcess.add(function(e,t){t.content=t.content.replace(/<p><\/p>/g,"<p> </p>")})}}(punymce),function(e){e.plugins.Emoticons=function(t){function n(e){var t;return o(c.emoticons,function(n,i){return o(n,function(n){if(n==e)return t=i,!1}),!t}),t}var o,i,a,c,d,l,u,g=e.Event;o=e.each,i=e.extend,e.isIE,a=e.isGecko,l=e.DOM,this.settings=c=i({emoticons:{happy:[":)","=)"],unhappy:[":|","=|"],sad:[":(","=("],grin:[":D","=D"],surprised:[":o",":O","=o","=O"],wink:[";)",":wink;"],halfhappy:[":/","=/"],tounge:[":P",":p","=P","=p"],lol:[":lol:"],mad:[":mad:"],rolleyes:[":roll:"],cool:["8)"]},row_length:4,trans_img:e.baseURL+"plugins/emoticons/img/trans.gif",skip_css:0,auto_convert:1},t.settings.emoticons),c.skip_css||l.loadCSS(e.baseURL+"/plugins/emoticons/css/editor.css"),d="",o(c.emoticons,function(e){o(e,function(e){0!=d.length&&(d+="|"),d+=e.replace(/([^a-zA-Z0-9])/g,"\\$1")})}),d=new RegExp(d,"g"),i(t.commands,{mceEmoticons:function(e,n,i){function a(e){return t.hideMenu=null,g.remove(document,"click",a),g.remove(t.getDoc(),"click",a),l.get(f+"_memoticons").style.display="none",1}var d,u,m=this,f=t.settings.id,p=l.getPos(i.target);if(t.hideMenu)return t.hideMenu();d=l.get(f+"_memoticons"),d||(d=l.get(f+"_t"),d=l.add(document.body,"div",{id:f+"_memoticons",class:"punymce_emoticons punymce"}),d=l.add(d,"table",{class:"punymce"}),d=l.add(d,"tbody"),u=c.row_length,o(c.emoticons,function(e,n){u==c.row_length&&(r=l.add(d,"tr"),u=0),u++,g.add(l.add(l.add(r,"td"),"a",{href:"#",class:"emoticon "+n}),"mousedown",function(o){return a.call(m),t.selection.setNode(t.dom.create("img",{title:e[0]||n,src:c.trans_img,class:"emoticon "+n})),g.cancel(o)})})),g.add(document,"click",a,m),g.add(t.getDoc(),"click",a,m),t.hideMenu=a,s=l.get(f+"_memoticons").style,s.left=p.x+"px",s.top=p.y+i.target.clientHeight+2+"px",s.display="block"}}),t.onPreProcess.add(function(e,n){var i=n.node.getElementsByTagName("img"),a=[];o(i,function(e){a.push(e)}),o(a,function(e){var n=t.dom.getAttr(e,"class");n&&n.indexOf("emoticon")!=-1&&e.parentNode.replaceChild(t.getDoc().createTextNode(e.getAttribute("title")),e)})}),t.onSetContent.add(function(e,t){var o=[];u=t.content.replace(/<\/?[^>]+>/g,function(e){return e.replace(d,function(e){return n(e)?(o.push(e),"¤"+o.length+"¤"):e})}),u=u.replace(d,function(e){return'<img src="'+c.trans_img+'" title="'+e+'" class="emoticon '+n(e)+'" />'}),u=u.replace(/¤([^¤]+)¤/g,function(e,t){return o[parseInt(t)-1]}),t.content=u}),t.onInit.add(function(){var o=t.dom;c.skip_css||o.loadCSS(e.baseURL+"/plugins/emoticons/css/content.css"),g.add(t.getDoc(),"controlselect",function(e){if(o.getAttr(e.target,"class").indexOf("emoticon")!=-1)return g.cancel(e)}),a&&(g.add(t.getDoc(),"mousedown",function(e){if(o.getAttr(e.target,"class").indexOf("emoticon")!=-1)return t.getDoc().execCommand("enableObjectResizing",!1,!1),g.cancel(e);t.getDoc().execCommand("enableObjectResizing",!1,!0)}),g.add(t.getDoc(),"keydown",function(e){var n,o,i,a,r=t.selection,s=r.getSel(),c=t.getDoc(),d=r.getRng();if(n=d.startContainer,o=d.startOffset,1!=n.nodeType&&n){if(39==e.keyCode&&o==n.nodeValue.length&&(i=n.nextSibling)&&"IMG"==i.nodeName)return i=i.nextSibling,d=c.createRange(),d.setStart(i,0),d.setEnd(i,0),s.removeAllRanges(),s.addRange(d),g.cancel(e);if(37==e.keyCode&&0==o&&(i=n.previousSibling)&&"IMG"==i.nodeName)return i=i.previousSibling,a=i.nodeValue.length,d=c.createRange(),d.setStart(i,a),d.setEnd(i,a),s.removeAllRanges(),s.addRange(d),g.cancel(e)}})),g.add(t.getDoc(),"keypress",function(i){function a(t){var n,o,i;return e.useTextRange?(f=f.duplicate(),f.moveStart("character",t),f.text):(n=f.startContainer,o=f.startOffset,i=f.endOffset,o>0&&3==n.nodeType?n.nodeValue.substring(Math.max(0,o+t),i):void 0)}var r,s,l,u=(t.getDoc(),t.selection),m=u.getSel(),f=u.getRng();if(e.isOldWebKit||!c.auto_convert)return!0;if(!/(ttp|ftp):/i.test(a(-4))&&(l=a(-1),r=l+String.fromCharCode(i.charCode||i.keyCode),d.lastIndex=0,l&&d.test(r)))return(s=n(r))?(e.useTextRange?(f=t.selection.getRng(),f.moveStart("character",-1),f.select()):(f.setStart(f.startContainer,f.startOffset-1),m.removeAllRanges(),m.addRange(f)),t.selection.setNode(o.create("img",{id:"emoticon",title:r,src:c.trans_img,class:"emoticon "+s})),r=o.get("emoticon"),o.setAttr(r,"id",""),t.selection.select(r),t.selection.collapse(0),g.cancel(i)):void 0})}),i(t.tools,{emoticons:{cmd:"mceEmoticons",title:e.I18n.emoticons}})},e.extend(e.I18n,{emoticons:"Insert emoticon"})}(punymce),function(e){e.plugins.EditSource=function(t){var n=e.DOM,o=e.extend,i=e.each,a=e.isWebKit,r=0;t.settings.editsource&&!t.settings.editsource.skip_css||n.loadCSS(e.baseURL+"/plugins/editsource/css/editor.css"),t.onBeforeGetContent.add(function(e,t){t.save&&r&&e.setContent(n.get(e.settings.id+"_editsourcearea").value,{load:!0})}),o(t.commands,{mceEditSource:function(e,o,s){var c,d=t.getIfr(),l=t.settings.id,u=t.width,g=t.height,m=n.get(l+"_editsource");return r?(r=0,n.removeClass(m,"active"),a||(d.style.display="block",c=n.get(l+"_edspacer"),c.parentNode.removeChild(c)),c=n.get(l+"_editsourcearea"),t.setContent(c.value,{load:!0}),c.parentNode.removeChild(c),i(n.select("li",l+"_c"),function(e){n.removeClass(e,"disabled")}),!1):(n.addClass(m,"active"),i(n.select("li",l+"_c"),function(e){e!=m&&n.addClass(e,"disabled")}),c=n.add(d.parentNode,"textarea",{id:l+"_editsourcearea",class:"editsource",style:"width:"+u+"px;height:"+g+"px;"}),c.value=t.getContent({save:!0}),c.focus(),a||(n.add(d.parentNode,"div",{id:l+"_edspacer",class:"spacer",style:"width:"+u+"px;height:"+g+"px;"}),d.style.display="none"),r=1,!1)}}),o(t.tools,{editsource:{cmd:"mceEditSource",title:e.I18n.editsource}})},e.extend(e.I18n,{editsource:"Edit HTML source"})}(punymce),function(e){e.plugins.Image=function(t){var n=e.I18n
;t.settings.image&&!t.settings.image.skip_css||e.DOM.loadCSS(e.baseURL+"/plugins/image/css/editor.css"),e.extend(t.commands,{mceInsertImage:function(e,o,i){var a,r=t.selection.getNode();(a=prompt(n.entersrc,"IMG"==r.nodeName?t.dom.getAttr(r,"src"):""))&&t.selection.setNode(t.dom.create("img",{src:a}))}}),e.extend(t.tools,{image:{cmd:"mceInsertImage",title:n.insertimage}})},e.extend(e.I18n,{insertimage:"Insert image",entersrc:"Enter the URL of the image"})}(punymce),function(e){e.plugins.Link=function(t){var n=e.I18n;t.settings.link&&!t.settings.link.skip_css||e.DOM.loadCSS(e.baseURL+"/plugins/link/css/editor.css"),e.extend(t.commands,{mceInsertLink:function(e,o,i){var a,r=t.selection.getNode();(a=prompt(n.enterhref,"A"==r.nodeName?t.dom.getAttr(r,"href"):""))&&t.execCommand("CreateLink",0,a)}}),e.extend(t.tools,{link:{cmd:"mceInsertLink",title:n.link},unlink:{cmd:"Unlink",title:n.unlink}})},e.extend(e.I18n,{link:"Insert link",unlink:"Unlink",enterhref:"Enter the URL of the link"})}(punymce),function(e){e.plugins.TextColor=function(t){var n,o=e.DOM,i=e.Event,a=e.each,s=e.extend;t.settings.textcolor&&!t.settings.textcolor.skip_css||o.loadCSS(e.baseURL+"/plugins/textcolor/css/editor.css"),n=s({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF"},t.settings.textcolor),s(t.commands,{mceColor:function(e,s,c){function d(e){return t.hideMenu=null,i.remove(document,"click",d),i.remove(t.getDoc(),"click",d),o.get(m+"_mcolor").style.display="none",1}var l,u,g=this,m=t.settings.id,f=o.getPos(c.target);if(t.hideMenu)return t.hideMenu();l=o.get(m+"_mcolor"),l||(l=o.get(m+"_t"),l=o.add(document.body,"div",{id:m+"_mcolor",class:"punymce_color punymce"}),l=o.add(l,"table",{class:"punymce"}),l=o.add(l,"tbody"),u=8,a(n.colors.split(","),function(e){8==u&&(r=o.add(l,"tr"),u=0),u++,i.add(o.add(o.add(r,"td"),"a",{href:"#",style:"background:#"+e}),"mousedown",function(n){return d.call(g),t.execCommand("forecolor",0,"#"+e),i.cancel(n)})})),i.add(document,"click",d,g),i.add(t.getDoc(),"click",d,g),t.hideMenu=d,n=o.get(m+"_mcolor").style,n.left=f.x+"px",n.top=f.y+c.target.clientHeight+2+"px",n.display="block"}}),s(t.tools,{textcolor:{cmd:"mceColor",title:e.I18n.textcolor}})},e.extend(e.I18n,{textcolor:"Text color"})}(punymce),function(e){var t=e.Event;e.plugins.Paste=function(n){function o(t){var o,i,s,c,d,l,u,g=[],m=n.selection;if(n.getWin().focus(),a&&(r=n.selection.getRng(),r.moveToBookmark(a),r.select()),o=t.split(/\r?\n/),o.length>1&&(t="",e.each(o,function(e){t+="<p>"+e+"</p>"}),!e.isIE)){if(n.execCommand("Delete"),m.setContent('<span id="marker"></span>'),n.dom.getParent(n.dom.get("marker").parentNode,function(e){if(g.push(e),/^(p|h[1-6]|div)$/i.test(e.nodeName))return!0})){for(n.onPaste.dispatch({text:t}),s=c="",d=0;d<g.length;d++)s+="</"+g[d].nodeName.toLowerCase()+">";for(d=g.length-1;d>=0;d--)c+="<"+g[d].nodeName.toLowerCase()+">";return t=s+t+c+'<span id="_caret">&nbsp;</span>',n.getBody().innerHTML=n.getBody().innerHTML.replace(/<span id=\"marker\"><\/span>/gi,t),i=n.dom.get("_caret"),e.isGecko||i.scrollIntoView(),l=n.getDoc().createRange(),l.setStartBefore(i),l.setEndAfter(i),m.setRng(l),void n.execCommand("Delete")}u=n.dom.get("marker"),u.parentNode.removeChild(u)}n.selection.setContent(t),n.onPaste.dispatch({text:t})}function i(e){var t,i,a,r=n.selection,s=r.getSel(),c=n.getBody();t=n.dom.add(c,"div",{id:"_mcePaste",style:"position:absolute;left:-10000px;top:"+c.scrollTop},"&nbsp;"),a=r.getRng(),t=t.firstChild,i=n.getDoc().createRange(),i.setStart(t,0),i.setEnd(t,1),s.removeAllRanges(),s.addRange(i),window.setTimeout(function(){var e,t=n.dom.get("_mcePaste");e=t.innerHTML,t.parentNode.removeChild(t),a&&r.setRng(a),o(e.replace(/[\r\n]/g,"").replace(/<(\/p|br\s*\/?)>/g,"\n").replace(/<!--.*?-->/g,"").replace(/<[^>]+>/g,""))},0)}var a;e.DOM;n.onPaste=new e.Dispatcher(n),n.onInit.add(function(){e.isOpera||(/Firefox\/2/.test(navigator.userAgent)?t.add(n.getDoc(),"keydown",function(t){((t.metaKey||t.ctrlKey)&&86==t.keyCode||t.shiftKey&&45==t.keyCode)&&(e.isIE&&(a=n.selection.getRng().getBookmark()),i(t))},this):t.add(e.isIE?n.getBody():n.getDoc(),"paste",function(e){return n.getWin().clipboardData?(o(n.getWin().clipboardData.getData("Text")),t.cancel(e)):e.clipboardData?(o(e.clipboardData.getData("text/plain")),t.cancel(e)):void i(e)}))})}}(punymce),function(e){e.plugins.Entities=function(e){var t,n,o,i,a,r="",s={};for(t=e.settings,t.entities="named",a=t.entity_list,a||(a="160,nbsp,161,iexcl,162,cent,163,pound,164,curren,165,yen,166,brvbar,167,sect,168,uml,169,copy,170,ordf,171,laquo,172,not,173,shy,174,reg,175,macr,176,deg,177,plusmn,178,sup2,179,sup3,180,acute,181,micro,182,para,183,middot,184,cedil,185,sup1,186,ordm,187,raquo,188,frac14,189,frac12,190,frac34,191,iquest,192,Agrave,193,Aacute,194,Acirc,195,Atilde,196,Auml,197,Aring,198,AElig,199,Ccedil,200,Egrave,201,Eacute,202,Ecirc,203,Euml,204,Igrave,205,Iacute,206,Icirc,207,Iuml,208,ETH,209,Ntilde,210,Ograve,211,Oacute,212,Ocirc,213,Otilde,214,Ouml,215,times,216,Oslash,217,Ugrave,218,Uacute,219,Ucirc,220,Uuml,221,Yacute,222,THORN,223,szlig,224,agrave,225,aacute,226,acirc,227,atilde,228,auml,229,aring,230,aelig,231,ccedil,232,egrave,233,eacute,234,ecirc,235,euml,236,igrave,237,iacute,238,icirc,239,iuml,240,eth,241,ntilde,242,ograve,243,oacute,244,ocirc,245,otilde,246,ouml,247,divide,248,oslash,249,ugrave,250,uacute,251,ucirc,252,uuml,253,yacute,254,thorn,255,yuml,402,fnof,913,Alpha,914,Beta,915,Gamma,916,Delta,917,Epsilon,918,Zeta,919,Eta,920,Theta,921,Iota,922,Kappa,923,Lambda,924,Mu,925,Nu,926,Xi,927,Omicron,928,Pi,929,Rho,931,Sigma,932,Tau,933,Upsilon,934,Phi,935,Chi,936,Psi,937,Omega,945,alpha,946,beta,947,gamma,948,delta,949,epsilon,950,zeta,951,eta,952,theta,953,iota,954,kappa,955,lambda,956,mu,957,nu,958,xi,959,omicron,960,pi,961,rho,962,sigmaf,963,sigma,964,tau,965,upsilon,966,phi,967,chi,968,psi,969,omega,977,thetasym,978,upsih,982,piv,8226,bull,8230,hellip,8242,prime,8243,Prime,8254,oline,8260,frasl,8472,weierp,8465,image,8476,real,8482,trade,8501,alefsym,8592,larr,8593,uarr,8594,rarr,8595,darr,8596,harr,8629,crarr,8656,lArr,8657,uArr,8658,rArr,8659,dArr,8660,hArr,8704,forall,8706,part,8707,exist,8709,empty,8711,nabla,8712,isin,8713,notin,8715,ni,8719,prod,8721,sum,8722,minus,8727,lowast,8730,radic,8733,prop,8734,infin,8736,ang,8743,and,8744,or,8745,cap,8746,cup,8747,int,8756,there4,8764,sim,8773,cong,8776,asymp,8800,ne,8801,equiv,8804,le,8805,ge,8834,sub,8835,sup,8836,nsub,8838,sube,8839,supe,8853,oplus,8855,otimes,8869,perp,8901,sdot,8968,lceil,8969,rceil,8970,lfloor,8971,rfloor,9001,lang,9002,rang,9674,loz,9824,spades,9827,clubs,9829,hearts,9830,diams,338,OElig,339,oelig,352,Scaron,353,scaron,376,Yuml,710,circ,732,tilde,8194,ensp,8195,emsp,8201,thinsp,8204,zwnj,8205,zwj,8206,lrm,8207,rlm,8211,ndash,8212,mdash,8216,lsquo,8217,rsquo,8218,sbquo,8220,ldquo,8221,rdquo,8222,bdquo,8224,dagger,8225,Dagger,8240,permil,8249,lsaquo,8250,rsaquo,8364,euro"),n=a.split(","),o=0;o<n.length;o+=2)s[String.fromCharCode(n[o])]=n[o+1],i=parseInt(n[o]).toString(16),r+="\\u"+"0000".substring(i.length)+i;r=new RegExp("["+r+"]","g"),e.onGetContent.add(function(e,t){"html"==t.format&&(t.content=t.content.replace(r,function(e){var t;return(t=s[e])&&(e="&"+t+";"),e}))})}}(punymce),function(e){e.plugins.Safari2x=function(t){function n(e,n){var o,i,r=t.getDoc();n=n||{},r.execCommand("FontName",!1,"_tmp"),d(t.dom.select("span"),function(t){"_tmp"==t.style.fontFamily&&(o=a(t,e,n),i||(i=o))}),o=o.firstChild,t.selection.getSel().setBaseAndExtent(i,0,o,o.nodeValue.length)}function o(e){var n,o=t.selection;o.setContent("<"+e+'><li id="_tmp"></li></'+e+">"),n=t.dom.get("_tmp"),n.id="",o.select(n),o.collapse(1)}function i(e){return t.dom.getParent(e,function(e){return/^(H[1-6]|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CODE|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|NOFRAMES|MENU|ISINDEX|SAMP)$/.test(e.nodeName)})}function a(e,n,o){var i,a=t.getDoc();return o=o||{},i=a.createElement(n),d(e.attributes,function(e){e.specified&&e.nodeValue&&i.setAttribute(e.nodeName,e.nodeValue)}),d(o,function(e,t){i.setAttribute(t,e)}),d(e.childNodes,function(e){i.appendChild(e.cloneNode(!0))}),e.parentNode.replaceChild(i,e),i}var s,c,d=e.each,l=e.Event;e.isOldWebKit&&(t.selection.getRng=function(){var e,n,o,i,a=this,r=a.getSel(),s=t.getDoc();if(r.anchorNode){e=s.createRange();try{n=s.createRange(),n.setStart(r.anchorNode,r.anchorOffset),n.collapse(1),o=s.createRange(),o.setStart(r.focusNode,r.focusOffset),o.collapse(1),i=n.compareBoundaryPoints(n.START_TO_END,o)<0,e.setStart(i?r.anchorNode:r.focusNode,i?r.anchorOffset:r.focusOffset),e.setEnd(i?r.focusNode:r.anchorNode,i?r.focusOffset:r.anchorOffset)}catch(e){}}return e},s=t.selection.setContent,t.selection.setContent=function(e,n){var o=this.getRng();try{s.call(this,e,n)}catch(n){b=t.dom.create("body"),b.innerHTML=e,d(b.childNodes,function(e){o.insertNode(e.cloneNode(!0))})}},c=t.selection.collapse,t.selection.collapse=function(e){try{c.call(this,e)}catch(e){}},t.onInit.add(function(){e.DOM.get(t.settings.id+"_r").style.display="none"}),t.onPreInit.add(function(){l.add(t.getDoc(),"click",function(e){if("A"==e.target.nodeName)return t.selection.select(e.target),l.cancel(e)}),l.add(t.getDoc(),"keydown",function(e){var n,o,i,a=t.selection;if((e.charCode>32||13==e.keyCode)&&(n=t.dom.getParent(a.getNode(),function(e){return"LI"==e.nodeName}))){if(a.getRng().startOffset,13!=e.keyCode){if(i=String.fromCharCode(e.charCode),!/^\w$/.test(i))return;return a.setContent(i),o=a.getRng(),a=a.getSel(),n=a.anchorNode,"LI"==n.nodeName?a.setBaseAndExtent(n,1,n,1):(n=n.nextSibling,a.setBaseAndExtent(n,1,n,1)),l.cancel(e)}if(!n.hasChildNodes())return n.nextSibling&&"LI"==n.nextSibling.nodeName?l.cancel(e):(o=t.dom.getParent(a.getNode(),function(e){return/(UL|OL)/.test(e.nodeName)}),n.parentNode.removeChild(n),void a.select(o.nextSibling));i=t.getDoc().createTextNode(" "),n.appendChild(i),window.setTimeout(function(){var e=a.getNode();e.firstChild&&" "==e.firstChild.nodeValue.charAt(0)&&(e.removeChild(e.firstChild),a.select(e))},1)}})}),e.extend(t.commands,{IncreaseFontSize:function(){var e=t.getDoc(),n=parseInt(e.queryCommandValue("FontSize"));e.execCommand("FontSize",!1,n+1+"px")},DecreaseFontSize:function(){var e=t.getDoc(),n=parseInt(e.queryCommandValue("FontSize"));n>0&&e.execCommand("FontSize",!1,n-1+"px")},Strikethrough:function(){n("strike")},CreateLink:function(e,t){n("a",{href:t,mce_href:t})},Unlink:function(){var e=t.selection;e.setContent(e.getContent().replace(/(<a[^>]+>|<\/a>)/,""))},RemoveFormat:function(){var e=t.selection;e.setContent(e.getContent().replace(/(<(span|b|i|strong|em|strike) [^>]+>|<(span|b|i|strong|em|strike)>|<\/(span|b|i|strong|em|strike)>|)/g,""))},FormatBlock:function(e,n){var o,s=t.selection;o=i(t.selection.getNode()),o&&(r=a(o,n.replace(/<|>/g,""))),s.select(r),s.collapse(1)},InsertUnorderedList:function(){o("ul")},InsertOrderedList:function(){o("ol")},Indent:function(){var e,n=i(t.selection.getNode());n&&(e=parseInt(n.style.paddingLeft)||0,n.style.paddingLeft=e+10+"px")},Outdent:function(){var e,n=i(t.selection.getNode());n&&(e=parseInt(n.style.paddingLeft)||0)>=10&&(n.style.paddingLeft=e-10+"px")}}))}}(punymce),function(e){e.plugins.Video=function(t){var n=e.I18n;t.settings.image&&!t.settings.image.skip_css||e.DOM.loadCSS(e.baseURL+"/plugins/video/css/editor.css"),e.extend(t.commands,{mceInsertVideo:function(o,i,a){var r=t.selection.getNode(),s=("IMG"==r.nodeName&&t.dom.getAttr(r,"src"),t.selection),c=s.getRng(),d=parent.Popover?parent.Popover:Popover;e.dialog=new d("/manageapp/util/Frames/addMediaSimple.jsp",{height:600,width:700,heading:n.insertvideo,showLoading:!1,closeButton:!0,dragable:!0,hideShutter:!0,fadeInTime:50,onClose:function(){if(void 0!==e.dialog.result){t.getWin().focus();try{c.select()}catch(e){}s.setNode(t.dom.create("img",e.dialog.result))}}}),e.dialog.show()}}),e.extend(t.tools,{video:{cmd:"mceInsertVideo",title:n.insertvideo}})},e.extend(e.I18n,{insertvideo:"Insert Video"})}(punymce),function(e){e.plugins.fwImage=function(t){var n=e.I18n;t.settings.image&&!t.settings.image.skip_css||e.DOM.loadCSS(e.baseURL+"/plugins/fwimage/css/editor.css"),e.extend(t.commands,{mceInsertFwImage:function(o,i,a){var r=(t.selection.getNode(),t.selection),s=r.getRng(),c=parent.Popover?parent.Popover:Popover;e.dialog=new c("/s/sitebuilder/dialogs/image",{height:230,width:650,heading:n.insertfwimage,closeButton:!0});var d=function(e){if(e){t.getWin().focus();try{s.select()}catch(e){}r.setNode(t.dom.create("img",{src:e.url}))}};e.dialog.bind?e.dialog.bind("submit",d):(parent.currentPopover=e.dialog,e.dialog.complete=function(t,n){"submit"===t&&(d(n),e.dialog.hide())}),e.dialog.show()}}),e.extend(t.tools,{fwimage:{cmd:"mceInsertFwImage",title:n.insertfwimage}})},e.extend(e.I18n,{insertfwimage:"Insert Image"})}(punymce),function(e){e.plugins.BBCode=function(t){t.onGetContent.add(function(t,n){("bbcode"==n.format||n.save)&&e.each([[/<a href=\"(.*?)\".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"],[/<font.*?color=\"([^\"]+)\".*?>(.*?)<\/font>/gi,"[color=$1]$2[/color]"],[/<img.*?src=\"([^\"]+)\".*?\/>/gi,"[img]$1[/img]"],[/<(br\s*\/)>/gi,"\n"],[/<(\/?)(strong|b)[^>]*>/gi,"[$1b]"],[/<(\/?)(em|i)[^>]*>/gi,"[$1i]"],[/<(\/?)u[^>]*>/gi,"[$1u]"],[/<(\/?)(code|pre)[^>]*>/gi,"[$1code]"],[/<(\/?)(span.*?class=\"quote\")[^>]*>(.*?)<\/span>/gi,"[$1quote]$3[/quote]"],[/<p>/gi,""],[/<\/p>/gi,"\n"],[/&quot;/gi,'"'],[/&lt;/gi,"<"],[/&gt;/gi,">"],[/&amp;/gi,"&"],[/<[^>]+>/gi,""]],function(e){n.content=n.content.replace(e[0],e[1])})}),t.onSetContent.add(function(t,n){("bbcode"==n.format||n.load)&&e.each([[/\n/gi,"<br />"],[/\[(\/?)b\]/gi,"<$1strong>"],[/\[(\/?)i\]/gi,"<$1em>"],[/\[(\/?)u\]/gi,"<$1u>"],[/\[(\/?)code\]/gi,"<$1pre>"],[/\[url\](.*?)\[\/url\]/gi,'<a href="$1">$1</a>'],[/\[url=([^\]]+)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'],[/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'],[/\[color=(.*?)\](.*?)\[\/color\]/gi,'<font color="$1">$2</font>'],[/\[quote.*?\](.*?)\[\/quote\]/gi,'<span class="quote">$1</span>']],function(e){n.content=n.content.replace(e[0],e[1])})})}}(punymce),function(e){e.plugins.Protect=function(t){var n,o=[];n=t.settings.protect||{},n.list||(n.list=[/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g]),t.onSetContent.add(function(t,i){e.each(n.list,function(e){i.content=i.content.replace(e,function(e){return o.push(e),"<!-- pro:"+(o.length-1)+" -->"})})}),t.onGetContent.add(function(e,t){t.content=t.content.replace(/<!-- pro:([0-9]+) -->/g,function(e,t){return o[parseInt(t)]})})}}(punymce);
